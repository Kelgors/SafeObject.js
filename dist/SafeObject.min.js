"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();!function(e){function t(){"undefined"!=typeof console&&i.debugMode&&(console.warn?console.warn.apply(console,arguments):console.log&&console.log.apply(console,arguments))}var r=[],n=function(){function e(t,r,n,o,s){_classCallCheck(this,e),this.enumerable="undefined"==typeof r||r,this.writable="undefined"==typeof n||n,this.configurable="undefined"==typeof o||o;var u=i.getRegisteredConstructor(t);u?(this.value=u.construct.bind(u),this.isFactory=!0):(this.isFactory="function"==typeof t&&"undefined"==typeof s||(s||!1),this.value=t)}return _createClass(e,[{key:"clone",value:function(){return new e(this.value,this.enumerable,this.writable,this.configurable,this.isFactory)}},{key:"toObject",value:function(){return{value:this.isFactory?this.value(this):this.value,enumerable:this.enumerable,writable:this.writable,configurable:this.configurable}}},{key:"toNullObject",value:function(){return{value:null,enumerable:this.enumerable,writable:this.writable,configurable:this.configurable}}}]),e}(),o=function(){function e(t){_classCallCheck(this,e),this.ConstructorFunction=t}return _createClass(e,[{key:"construct",value:function(){return new this.ConstructorFunction}}]),e}(),i=function(){function e(){_classCallCheck(this,e),e.setInstanceProperties(this,e.SAFE_OBJECT_INITIALIZE),this._isDestroyed=!1}return _createClass(e,null,[{key:"debug",value:function(t){var r=[];return r.push("----- SafeObject debug -----"),r.push("Constructor: "+String(t.constructor.name)),r.push("_isSafeObject: "+String(!!t._isSafeObject)),t._isSafeObject&&!function(){var n=e.getAncestors(t);r.push("Ancestors: "+n.map(function(e){return e.name}).join(" < "));var o=e.getRegisteredPropertyNames(t),i="function"==typeof t._getIgnoredSafeObjectPropertyNames?t._getIgnoredSafeObjectPropertyNames():[],s=i.concat(o),u=Object.getOwnPropertyNames(t).filter(function(e){return s.indexOf(e)===-1});r.push("ignored properties: "+i.join(", ")),r.push("registered properties: "+o.join(", ")),r.push("unregistered properties: "+u.join(", "))}(),r.join("\n")}},{key:"include",value:function(t){if(t.constructor===Object)throw"Cannot include an Object";if(e.isSafeObject(t))return t;t._isDestroyed=!1,t.constructor.INSTANCE_PROPERTIES||(t.constructor.INSTANCE_PROPERTIES={});var r=e.getRegisteredProperties(t);if(!("_isSafeObject"in r)){var o=e.getAncestors(t).reverse(),i=o.find(function(e){return!!e.INSTANCE_PROPERTIES});i||(i=t.constructor),r._isSafeObject=i.INSTANCE_PROPERTIES._isSafeObject=new n((!0),(!1),(!1),(!0))}return"function"!=typeof t._getIgnoredSafeObjectPropertyNames&&(t._getIgnoredSafeObjectPropertyNames=e.prototype._getIgnoredSafeObjectPropertyNames),e.setProperties(t,e.SAFE_OBJECT_INITIALIZE,r),t}},{key:"getRegisteredConstructor",value:function(e){return r.find(function(t){return t.ConstructorFunction===e})}},{key:"registerConstructor",value:function(e){r.push(new o(e))}},{key:"unregisterConstructor",value:function(e){var t=r.findIndex(function(t){return t.ConstructorFunction===e});return r.splice(t,1)[0]}},{key:"isSafeObject",value:function(e){return e&&e._isSafeObject===!0}},{key:"getAncestors",value:function(e){for(var t=e.constructor,r=[];t=Object.getPrototypeOf(t.prototype)?Object.getPrototypeOf(t.prototype).constructor:null;)r.push(t||[]);return r}},{key:"getRegisteredProperties",value:function(t){var r=[t.constructor].concat(e.getAncestors(t)).map(function(e){return e.INSTANCE_PROPERTIES}).reverse();return Object.assign.apply(Object,[{}].concat(_toConsumableArray(r)))}},{key:"getUnregisteredPropertyNames",value:function(t){var r=e.getRegisteredPropertyNames(t),n="function"==typeof t._getIgnoredSafeObjectPropertyNames?t._getIgnoredSafeObjectPropertyNames():[];return r.push.apply(r,n),Object.getOwnPropertyNames(t).filter(function(e){return r.indexOf(e)===-1})}},{key:"getRegisteredPropertyNames",value:function(t){return Object.getOwnPropertyNames(e.getRegisteredProperties(t))}},{key:"setInstanceProperties",value:function(t,r){e.setProperties(t,r,e.getRegisteredProperties(t))}},{key:"setProperties",value:function(r,n,o){for(var i in o)try{var s=e.parsePropertyDescriptor(o[i]);e.setProperty(r,i,s,n)}catch(u){t("SafeObject#setProperties: "+u.toString())}}},{key:"setProperty",value:function(r,n,o,i){if(!o)return void t("Property descriptor isnt well formed for "+String(n)+".");var s=void 0;i===e.SAFE_OBJECT_DESTROY?s=o.toNullObject():i===e.SAFE_OBJECT_INITIALIZE&&(s=o.toObject()),Object.defineProperty(r,n,s)}},{key:"parsePropertyDescriptor",value:function(e){return e&&e instanceof n?e:new n(e)}}]),_createClass(e,[{key:"destroy",value:function(){e.setInstanceProperties(this,e.SAFE_OBJECT_DESTROY),this._isDestroyed=!0}},{key:"_getIgnoredSafeObjectPropertyNames",value:function(){return["_isDestroyed"]}}]),e}();Object.defineProperties(i,{debugMode:{enumerable:!1,writable:!0,configurable:!0,value:!1},VERSION:{enumerable:!1,writable:!1,configurable:!1,value:"1.2.4"},SAFE_OBJECT_INITIALIZE:{enumerable:!1,writable:!1,configurable:!1,value:1},SAFE_OBJECT_DESTROY:{enumerable:!1,writable:!1,configurable:!1,value:2},INSTANCE_PROPERTIES:{enumerable:!0,writable:!0,configurable:!0,value:{_isSafeObject:new n((!0),(!1),(!1),(!0))}},PropertyDescriptor:{enumerable:!0,writable:!0,configurable:!0,value:n}}),i.registerConstructor(Object),i.registerConstructor(Array),i.registerConstructor(Date),"undefined"!=typeof WeakSet&&i.registerConstructor(WeakSet),"undefined"!=typeof WeakMap&&i.registerConstructor(WeakMap),"undefined"!=typeof Map&&i.registerConstructor(Map),"undefined"!=typeof Set&&i.registerConstructor(Set);var s="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self.self===self&&self||"object"==("undefined"==typeof global?"undefined":_typeof(global))&&global.global===global&&global;"function"==typeof define&&define.amd?define(function(){return i}):"undefined"!=typeof module&&"exports"in module?module.exports=i:s[e]=i}("SafeObject");