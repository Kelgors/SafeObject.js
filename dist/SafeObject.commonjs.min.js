"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),SafeObject=function(){function e(){_classCallCheck(this,e),this._clearAllInstanceProperties(e.SAFE_OBJECT_INITIALIZE),this._isSafeObject=!0}return _createClass(e,null,[{key:"debug",value:function(e){console.log("----- SafeObject debug -----"),console.log("Constructor: ",e.constructor.name),console.log("_isSafeObject: "+String(e._isSafeObject)),e._isSafeObject&&!function(){e._getAncestors();console.log("Ancestors: "+e._getAncestors().map(function(e){return e.name}).join(" > "));var t=e._getAttributes().map(function(e){return Array.isArray(e)?e[0]:e}),r=["_isSafeObject","destroy","_getAncestors","_getAttributes","_clearAllInstanceProperties","_parsePropertyDescriptor"].concat(t),n=Object.getOwnPropertyNames(e).filter(function(e){return-1===r.indexOf(e)});console.log("registered attributes: ",t.join(", ")),console.log("unregistered attributes: ",n.join(", "))}()}},{key:"include",value:function(t){if(t._isSafeObject)return t;["destroy","_getAncestors","_getAttributes","_clearAllInstanceProperties","_parsePropertyDescriptor"].forEach(function(r){"destroy"===r&&"function"==typeof t[r]?!function(){var n=t[r];t[r]=function(){e.prototype[r].call(this,arguments),n.apply(this,arguments)}}():t[r]=e.prototype[r]}),t._isSafeObject=!0;var r=t.constructor.INSTANCE_PROPERTIES;return r&&r.length&&t._clearAllInstanceProperties(e.SAFE_OBJECT_INITIALIZE),t}}]),_createClass(e,[{key:"destroy",value:function(){this._clearAllInstanceProperties(e.SAFE_OBJECT_DESTROY)}},{key:"_getAncestors",value:function(){for(var e=this.constructor,t=[];e=Object.getPrototypeOf(e.prototype)?Object.getPrototypeOf(e.prototype).constructor:null;)t.push(e||[]);return t}},{key:"_getAttributes",value:function(){for(var e=[this.constructor].concat(this._getAncestors()),t=[],r=0;r<e.length;r++)t.push.apply(t,e[r].INSTANCE_PROPERTIES);return t}},{key:"_clearAllInstanceProperties",value:function(t){for(var r=(this.constructor,this._getAttributes()),n=0;n<r.length;n++)try{var o=r[n],s=void 0,c=void 0;"string"==typeof o?(s=o,c=this._parsePropertyDescriptor()):Array.isArray(o)&&(s=o[0],c=this._parsePropertyDescriptor(o[1])),t===e.SAFE_OBJECT_INITIALIZE&&s&&c?Object.defineProperty(this,s,c):t===e.SAFE_OBJECT_DESTROY&&s&&(this[s]&&"function"==typeof this[s].destroy&&this._isSafeObject&&this[s].destroy(),this[s]=null)}catch(i){console.log("SafeObject#_clearAllInstanceProperties: "+i.toString())}}},{key:"_parsePropertyDescriptor",value:function(e){if(!e||e.constructor!==Object)return{writable:!0,configurable:!0,enumerable:!0,value:null};var t=e;return"value"in t||(t.value=null),"enumerable"in t||(t.enumerable=!0),"configurable"in t||(t.configurable=!0),"writable"in t||(t.writable=!0),t}}]),e}();exports["default"]=SafeObject,SafeObject.SAFE_OBJECT_INITIALIZE=1,SafeObject.SAFE_OBJECT_DESTROY=2;